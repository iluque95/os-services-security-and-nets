# Seguridad y Administración de Redes

Informes a modo de guía al estilo RFC escritos por mi de principio a fin para la asignatura SEAX.

Por cada sesión hay informes parciales de cada conjunto de tareas y se reunen en un informe final para cada una de las sesiones.

Los informes presentan un índice automáticamente generado por un programa que desarrollé. Para indexar un título se require adjuntar el carácter almohadilla junto a un espacio al principio de una palabra. El programa recorrerá todo el fichero designando la línea encontrada y auto arreglando el incremento de líneas al índice.

## Contenidos

### Sesión 1

```
(*) Pràctica 1 - Sessió 5 - Avaluació. (Luque Díaz Itiel).............................................................................1
	(*) REQUERIMENTS.................................................................................................................65
	(*) FITXERS MODIFICATS...........................................................................................................87
	(*) CANVIS EN LA MÀQUINA.........................................................................................................97
	(*) DEDUCCIONS SCRIPTS..........................................................................................................117
	(*) PROBLEMÀTIQUES SCRIPTS......................................................................................................127
(*) Pràctica 1 - Sessió 1 - Creació d'un servidor Debian amb VirtualBox. (Luque Díaz Itiel).........................................134
	(*) PROGRAMARI NECESSARI........................................................................................................138
	(*) DESCRIPCIÓ..................................................................................................................149
	(*) ASPECTES A CONSIDERAR.......................................................................................................163
	(*) INSTAL·LACIONS PRÈVIES......................................................................................................189
	(*) REPLICACIÓ DE LES MÀQUINES..................................................................................................258
	(*) GESTIÓ DE LA XARXA..........................................................................................................384
	(*) PERIFÈRICS I COMPARTICIÓ....................................................................................................427
	(*) ACCÉS REMOT.................................................................................................................442
	(*) SEGURETAT USUARIS...........................................................................................................455
(*) Pràctica 1 - Sessió 2 - Configuració de les interfícies de xarxa Ethernet. (Luque Díaz, Itiel)..................................542
	(*) PROGRAMARI NECESSARI........................................................................................................546
	(*) FITXERS RELACIONATS.........................................................................................................554
	(*) DESCRIPCIÓ..................................................................................................................566
	(*) ACTIVACIÓ/DESACTIVACIÓ D'INTERFÍCIES........................................................................................579
	(*) REANOMENAMENT D'UNA INTERFÍCIE..............................................................................................602
	(*) CONFIGURACIÓ DE LES INTERFÍCIES.............................................................................................648
	(*) CONÈIXER IP EXTERNA.........................................................................................................732
	(*) RESOLUCIÓ DE NOMS...........................................................................................................773
	(*) PROGRAMAR UN SHELL SCRIPT...................................................................................................822
(*) Pràctica 1 - Sessió 3 - Configuració de les interfícies de xarxa Wi-Fi. (Luque Díaz, Itiel).....................................840
	(*) PROGRAMARI NECESSARI........................................................................................................844
	(*) FITXERS RELACIONATS.........................................................................................................856
	(*) DESCRIPCIÓ..................................................................................................................869
	(*) ACTIVACIÓ/DESACTIVACIÓ D'INTERFÍCIES........................................................................................882
	(*) REANOMENAMENT D'UNA INTERFÍCIE..............................................................................................905
	(*) CONFIGURACIÓ DE LES INTERFÍCIES.............................................................................................951
	(*) CONÈIXER IP EXTERNA........................................................................................................1035
	(*) RESOLUCIÓ DE NOMS..........................................................................................................1076
	(*) RECONEIXER INTERFÍCIE WIFI.................................................................................................1125
	(*) INSTAL·LACIÓ DEL DRIVER....................................................................................................1139
	(*) CONFIGURACIÓ D'INTERFÍCIES WIFI............................................................................................1216
	(*) ESCANEIG XARXES SENSE FILS.................................................................................................1406
	(*) PROGRAMAR UN SHELL SCRIPT..................................................................................................1516
(*) Pràctica 1 - Sessió 4 - Accés al servidor mitjançant SSH. (Luque Díaz, Itiel)..................................................1534
	(*) PROGRAMARI NECESSARI.......................................................................................................1538
	(*) FITXERS RELACIONATS........................................................................................................1548
	(*) DESCRIPCIÓ.................................................................................................................1559
	(*) INSTAL·LACIÓ SSH...........................................................................................................1570
	(*) CONFIGURACIÓ DE L'SSH......................................................................................................1631
	(*) GENERACIÓ D'UN CERTIFICAT..................................................................................................1830
	(*) DISTRIBUCIÓ DEL CERTIFICAT.................................................................................................1875
	(*) TUNNEL SSH.................................................................................................................1923
	(*) REFERÈNCIES BIBLIOGRÀFIQUES................................................................................................2028
```

### Sesión 2

```
(*) Pràctica 2 - Avaluació. (Luque Díaz Itiel).........................................................46
	(*) REQUERIMENTS...................................................................................56
	(*) FITXERS MODIFICATS.............................................................................80
	(*) CANVIS EN LA MÀQUINA..........................................................................139
	(*) DEDUCCIONS....................................................................................188
	(*) CONSIDERACIONS................................................................................202
	(*) PROGRAMARI NECESSARI..........................................................................211
	(*) FITXER RELACIONATS............................................................................224
	(*) RESOL·LUCIÓ DISTINCTIVA D'IPS PRIVADES I PÚBLIQUES............................................232
	(*) DDNS AMB VISTES INTERNA I PÚBLICA.............................................................499
(*) Pràctica 2 - Sessió 1 - Implementar un servei DNS. (Luque Díaz Itiel).............................675
	(*) PROGRAMARI NECESSARI..........................................................................679
	(*) FITXER RELACIONATS............................................................................687
	(*) ESCENARI......................................................................................698
	(*) DESCRIPCIÓ....................................................................................708
	(*) CONFIGURACIÓ SERVIDOR DNS.....................................................................716
	(*) DELEGACIÓ D'UN SUBDOMINI.....................................................................1074
	(*) MOSTREIG CACHE LOCAL.........................................................................1228
	(*) COORDINACIÓ DHCP I DNS.......................................................................1272
	(*) SCRIPT.......................................................................................1279
(*) Pràctica 2 - Sessió 2 - Implementar un servei DHCP. (Luque Díaz Itiel)...........................1382
	(*) PROGRAMARI NECESSARI.........................................................................1386
	(*) FITXER RELACIONATS...........................................................................1394
	(*) ESCENARI.....................................................................................1407
	(*) DESCRIPCIÓ...................................................................................1416
	(*) CONFIGURACIÓ SERVIDOR DHCP...................................................................1426
	(*) CONFIGURACIÓ CLIENT..........................................................................1546
	(*) DNS DINÀMIC..................................................................................1647
	(*) SCRIPT.......................................................................................1801
(*) Pràctica 2 - Sessions 3 i 4 -Encaminament i tallafocs. (Luque Díaz Itiel)........................1820
	(*) PROGRAMARI NECESSARI.........................................................................1824
	(*) FITXER RELACIONATS...........................................................................1835
	(*) ESCENARI.....................................................................................1845
	(*) DESCRIPCIÓ...................................................................................1896
	(*) CONFIGURACIÓ QUAGGA..........................................................................1904
	(*) SORTIDA A INTERNET...........................................................................2152
	(*) CONFIGURACIÓ IPTABLES........................................................................2211
	(*) COMUNICACIONS XARXES.........................................................................2248
	(*) SCRIPTS......................................................................................2423
	(*) REFERÈNCIES BIBLIOGRÀFIQUES..................................................................2799
```

### Sesión 3

```
(*) Pràctica 3 - Avaluació. (Luque Díaz Itiel)...............................................................................79
	(*) REQUERIMENTS.........................................................................................................88
	(*) ESCENARI............................................................................................................119
	(*) PROGRAMARI NECESSARI................................................................................................146
	(*) FITXERS MODIFICATS..................................................................................................154
	(*) CANVIS EN LA MÀQUINA................................................................................................177
	(*) DEDUCCIONS..........................................................................................................211
	(*) CONSIDERACIONS......................................................................................................233
	(*) CREACIÓ D'UN RAID Z2 AMB ZFS........................................................................................270
	(*) CONFIGURACIÓ DISCOS SPARE...........................................................................................325
	(*) AFEGIR USUARIS ENTEL I SEAX.........................................................................................362
	(*) ENGABIAMENT SFTP....................................................................................................388
	(*) COMPROVACIONS SFTP..................................................................................................426
	(*) AUTOMUNTATGE SFTP...................................................................................................550
	(*) CONFIGURACIÓ SMB....................................................................................................609
	(*) COMPROVACIÓ DE FUNCIONAMENT SMB.....................................................................................683
	(*) AUTOMUNTAGE SMB.....................................................................................................825
	(*) CONFIGURACIÓ VHOSTS I WEBDAV APACHE2................................................................................898
	(*) COMPROVACIÓ WEBDAV.................................................................................................1071
	(*) AUTOMUNTATGE WEBDAV................................................................................................1364
	(*) CONFIGURACIÓ SERVIDOR OPENVPN......................................................................................1533
	(*) CONFIGURACIÓ CLIENT OPENVPN........................................................................................1561
	(*) COMPROVACIÓ CLIENT OPENVPN.........................................................................................1617
	(*) ESTRUCTURA DE FITXERS, PERMISOS I PROVES (FIREWALL ACTIVAT)........................................................1658
	(*) CAPTURA DE PAQUETS DELS SERVEIS AMB FIREWALL I NAT.................................................................1913
(*) Pràctica 3 - Sessió 1 - Accés al servidor mitjançant SFTP i SAMBA. (Luque Díaz Itiel)..................................2817
	(*) PROGRAMARI NECESSARI...............................................................................................2820
	(*) FITXER RELACIONATS.................................................................................................2833
	(*) DESCRIPCIÓ.........................................................................................................2841
	(*) CONFIGURACIÓ SFTP..................................................................................................2849
	(*) MUNTATGE RECURS SFTP...............................................................................................2920
	(*) COMPARTICIÓ D'UN RECURS SFTP.......................................................................................3035
	(*) CONFIGURACIÓ SMB...................................................................................................3054
	(*) COMPARTICIÓ RECURSOS SMB...........................................................................................3098
	(*) CLIENT I MUNTATGE SMB..............................................................................................3139
	(*) SEGURETAT..........................................................................................................3279
	(*) BACKUPS............................................................................................................3322
	(*) AUTOMATITZACIÓ AMB CRON............................................................................................3512
(*) Pràctica 3 - Sessió 2 - Crear un raid/cluster de discs en xarxa. (Luque Díaz Itiel)....................................3552
	(*) PROGRAMARI NECESSARI...............................................................................................3555
	(*) FITXER RELACIONATS.................................................................................................3564
	(*) DESCRIPCIÓ.........................................................................................................3577
	(*) CREACIÓ D'UN RAID AMB MDADM........................................................................................3585
	(*) ADMINISTRACIÓ D'UN RAID AMB MDADM..................................................................................4488
	(*) CREACIÓ D'UN RAID Z AMB ZFS........................................................................................4583
	(*) RECUPERACIÓ RAIDZ..................................................................................................4688
	(*) CREACIÓ DE CLUSTER DE DISCOS AMB DRBD..............................................................................4868
	(*) RECUPERACIÓ CLUSTER DE DISCOS......................................................................................5077
	(*) COMPARTICIÓ RAID SMB...............................................................................................5266
	(*) SEGURETAT..........................................................................................................5354
	(*) PROGRAMARI NECESSARI...............................................................................................5384
	(*) FITXER RELACIONATS.................................................................................................5394
	(*) COMANDES APACHE2...................................................................................................5404
	(*) CONSIDERACIONS.....................................................................................................5412
	(*) DESCRIPCIÓ.........................................................................................................5419
	(*) CONFIGURACIÓ D'UN VIRTUALHOST APACHE2..............................................................................5429
	(*) CONFIGURACIÓ VIRTUALHOST SEGUR (SSL) APACHE2.......................................................................5545
	(*) CONFIGURACIÓ WEBDAV APACHE2........................................................................................5683
	(*) WEBMIN.............................................................................................................5890
	(*) SEGURETAT..........................................................................................................5934
(*) Pràctica 3 - Sessió 4 - Implementar un servei de xarxa privada virtual. (Luque Díaz Itiel).............................5958
	(*) PROGRAMARI NECESSARI...............................................................................................5961
	(*) FITXER RELACIONATS.................................................................................................5970
	(*) ESCENARI...........................................................................................................5977
	(*) COMANDES OPENVPN...................................................................................................5990
	(*) CONSIDERACIONS.....................................................................................................6000
	(*) DESCRIPCIÓ.........................................................................................................6008
	(*) CREACIÓ I CONFIGURACIÓ CA..........................................................................................6021
	(*) CONFIGURACIÓ SERVIDOR OPENVPN......................................................................................6155
	(*) GENERACIÓ FITXER DE CONFIGURACIÓ .OVPN.............................................................................6255
	(*) CONFIGURACIÓ CLIENT LINUX OPENVPN..................................................................................6496
	(*) SEGURETAT..........................................................................................................6551
(*) REFERÈNCIES BIBLIOGRÀFIQUES............................................................................................6605
```

## Scripts

- Obtención información DHCP.
- Obtención de información de la red: Usuarios activos, nombre del equipo, DNS, IP local, externa, etc.
- Listado de reglas firewall iptables.
- Detección de problemas en ficheros de configuración de red.
- Obtención de información de redes wifi: Nombre, cifrado, frecuencia, canal, ESSID, MAC, calidad, etc.
- Captura de posibles redes mal intencionadas.


## License
[MIT](https://choosealicense.com/licenses/mit/)
